---
version: 0.1
describe: cross_check_pets

do: [
  $vars: {
    page_size: :global.page_size.regular,
    page: 1,
    pets_resp: null,
    total_page: 1,
  },

  $set: {
    pets_resp: {
      $invoke: {
        spec: specs.get_pet_all.get_with_page_from_arg, 
        args: {page_size: :page_size, page: :page}
      }
    },
  },

  $set: {
    total_page: :pets_resp.data.meta.total,
  },

  $for: {
    condition: {$test.lte: [:page, :total_page]},
    does: [
      $invoke: {
        spec: specs.get_pet_all.get_with_page_from_arg, 
        args: {page_size: :page_size, page: :page}
      },

      $incr: [page, 1]
    ]
  }
]
