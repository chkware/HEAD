---
version: 0.1
describe: get_pet_by_id.{spec} {pet_id}

specs:
  - it: get_with_number
    with: 
      pet_id: 1
      server: ${global.server}
    expect: pass
  
  - it: get_with_string
    expect: fail
    with:
      id: 'invalid string'
      server: ${global.server}
  
  - it: get_without_id
    expect: fail
    with:
      server: ${global.server}
    without: [id]
  
  - it: get_with_float
    expect: fail
    with:
      id: 3.5

vars:
  pet_id: integer

  # think about model more
  # var type & validation criteria placement conflict
  models:
    pet:
      id: integer
      name: required|string
      breed: required|string|in:cat,dog

do: |
  # import system libs
  (Use fetch)
  (Use assert)
  (Use parse)

  # call api
  (Var pet_str (fetch.GET "%{server}/pets/%{pet_id}"))

  # parse response to json
  (Var pet (parse.ParseJson pet_str models.pet))

  # assert with model
  (assert.Assert pet models.pet)

  # export to caller
  (Expose pet)



# need a way to export values with named parameters and type
# need response parsing
# need response validation
# need way to define context params