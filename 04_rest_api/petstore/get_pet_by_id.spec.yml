---
version: 0.1
describe: get_pet_by_id {pet_id?}

specs:
  - it: get_with_number
    default: true
    with: 
      pet_id: 1
    expect: pass
  
  - it: get_with_string
    expect: fail
    with:
      id: 'invalid string'
  
  - it: get_without_id
    expect: fail
    without: [id]
  
  - it: get_with_float
    expect: fail
    with:
      id: 3.5

vars:
  pet_id: 
  server: ${global.server}
  
  # model
  model_pet: {
    "id": "integer",
    "name": "required|string",
    "breed": "required|string|in:cat,dog"
  }

do: |
  # prepare request
  
  var(url, string.format("${}/pets/${}", server, pet_id))

  # call api

  var(response, http.get(url))
  var(pet_str, response.body)

  # parse response to json
  # inharently should call assert.assert

  var(pet, parse.parseJson(pet_str, model_pet))

  # export to caller
  expose(pet)
  expose(response)
